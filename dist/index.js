"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.withYMCustom=exports.default=void 0;var _react=require("react"),prodLytics=_interopRequireWildcard(require("./analytics/prod")),devLytics=_interopRequireWildcard(require("./analytics/dev"));function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _possibleConstructorReturn(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:_assertThisInitialized(a)}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function isLocal(a){return location.hostname===a}function isDev(){return"production"!==process.env.NODE_ENV}var WithAnalytics=/*#__PURE__*/function(a){function b(){var a,c;_classCallCheck(this,b);for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=_possibleConstructorReturn(this,(a=_getPrototypeOf(b)).call.apply(a,[this].concat(e))),_defineProperty(_assertThisInitialized(c),"state",{analytics:void 0}),c}return _inherits(b,a),_createClass(b,[{key:"componentDidMount",value:function componentDidMount(){// check if it should track
var a=isLocal(this.state.localhost)||isDev(),b=a?devLytics:prodLytics;// check if it should use production or dev analytics
b.init(this.state.code,this.state.options,this.state.version||2),b.pageview();// save possible previously defined callback
var c=this.state.router.onRouteChangeComplete;this.state.router.onRouteChangeComplete=function(){"function"==typeof c&&c(),b.pageview()},this.setState({analytics:b})}},{key:"render",value:function render(){return(0,_react.createElement)(this.state.page_component,_objectSpread({},this.props,{analytics:this.state.analytics}))}}]),b}(_react.Component),_default=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},d=c.localhost,e=void 0===d?"localhost":d;return function(c){var d=/*#__PURE__*/function(d){function f(d){var g;return _classCallCheck(this,f),g=_possibleConstructorReturn(this,_getPrototypeOf(f).call(this,d)),g.state=_objectSpread({},g.state,{code:a,router:b,localhost:e,page_component:c}),g}return _inherits(f,d),f}(WithAnalytics);return c.getInitialProps&&(d.getInitialProps=c.getInitialProps),d}};exports.default=_default;var withYMCustom=function(a,b,c,d){var e=4<arguments.length&&arguments[4]!==void 0?arguments[4]:{},f=e.localhost,g=void 0===f?"localhost":f;return function(e){var f=/*#__PURE__*/function(f){function h(f){var i;return _classCallCheck(this,h),i=_possibleConstructorReturn(this,_getPrototypeOf(h).call(this,f)),i.state=_objectSpread({},i.state,{code:a,options:b,version:c,router:d,localhost:g,page_component:e}),i}return _inherits(h,f),h}(WithAnalytics);return e.getInitialProps&&(f.getInitialProps=e.getInitialProps),f}};exports.withYMCustom=withYMCustom;